function uploadSHP(a){"function"==typeof a&&$("#dlgUploadSHP").one("hide.bs.modal",function(){var n=$("#modal-result",this).val();n&&a(n)}),$("#dlgUploadSHP").modal("show")}$("#dlgUploadSHP").on("show.bs.modal",function(a){$("li",this).remove(),$("#drop",this).show(),$("#modal-result",this).val("")}),$(function(){function a(a){return"number"!=typeof a?"":a>=1e9?(a/1e9).toFixed(2)+" GB":a>=1e6?(a/1e6).toFixed(2)+" MB":(a/1e3).toFixed(2)+" KB"}var n=$("#upload ul");$("#drop a").click(function(){$(this).parent().find("input").click()}),$("#upload").fileupload({dropZone:$("#drop"),add:function(o,t){$("#drop").hide();var i=$('<li class="working"><div class="col-xs-8">\t<input type="text" value="0" data-width="48" data-height="48" data-fgColor="#0788a5" data-readOnly="1" data-bgColor="#3e4043" /><p></p></div><div class="col-xs-3"><div class="pull-right btn-toolbar">\t<a href="#" class="btn btn-danger"><span class="glyphicon glyphicon-trash"></span></a>\t<a href="#" class="btn btn-primary"><span class="glyphicon glyphicon-upload"></span></a></div></div><div class="clearfix" style="height:75px"></div><div class="message"></div></li>');t.msgboard=i.find(".message"),i.find("p").text(t.files[0].name).append("<i>"+a(t.files[0].size)+"</i>"),t.context=i.appendTo(n),i.find("input").knob(),i.find("a.btn-danger").click(function(){i.hasClass("working")&&void 0!==e&&e.abort(),i.fadeOut(function(){i.remove(),$("#drop").show()})});var e;t.handleError=function(){t.context.addClass("error"),t.msgboard.html('<div class="alert alert-danger alert-dismissible fade in" role="alert">\t<button type="button" class="close" data-dismiss="alert" aria-label="Close">\t    <span aria-hidden="true">&times;</span>\t</button>\t<strong>'+t.msg+"</strong></div>")},i.find("a.btn-primary").click(function(){$(this).fadeOut(),"undefined"!=typeof GEOSICOB_KEY&&$('#upload input[name="session_key"]').val(GEOSICOB_KEY),t.form[0].action=GEOSICOB_URL+"geosicob_upload.php",e=t.submit().fail(function(a,n,o){t.msg=o,t.handleError.call()}).always(function(a,n,o){if("success"===n){if("0"===a.success)return t.msg=a.msg,t.handleError.call(),void i.find("a.btn-primary").fadeIn();$("#upload #modal-result").val(JSON.stringify(a)),$("#dlgUploadSHP .close").click()}})})},progress:function(a,n){var o=parseInt(n.loaded/n.total*100,10);n.context.find("input").val(o).change(),100==o&&(n.context.removeClass("working"),$('<h2 class="text-center text-info"><span class="glyphicon glyphicon-refresh glyphicon-refresh-animate"></span> Analizando archivo...</h2>').hide().appendTo(n.msgboard).fadeIn())}}),$(document).on("drop dragover",function(a){a.preventDefault()})});