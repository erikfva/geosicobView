function showFrmProcess(e){$(".sidebar-close:visible").trigger("click");var o=$("#dlg-frmgeoprocess");o.length?o.find(".modal-title").html(e.title).end().find(".modal-body").empty().append(tmpl(e.templates.input,e)):o=$("body").append(tmpl("tmpl-frmgeoprocess",e)).find("#dlg-frmgeoprocess"),o.find(".msg-board").hide(),o.modal("show")}function runGeoprocess(e){if(!e.actions||!e.actions.onBeforeRun||""===e.actions.onBeforeRun||"function"!=typeof window[e.actions.onBeforeRun]||window[e.actions.onBeforeRun]()){var o=$("#dlg-frmgeoprocess form"),s=o.serializeFormJSON(),r=o.find("#btnsubmit");return s.x_proceso=e.id,s.opciones="webservice",s.x_opcionestxt="",s.session_key=GEOSICOB_KEY,r.button("loading"),showAlertMsg({container:"#dlg-frmgeoprocess .msg-board",typemsg:"alert-info",msg:"<h4>Espere por favor...</h4>",delay:0}),$.ajax({type:"post",url:GEOSICOB_URL+"geoprocesamientoadd.php",data:s,success:function(o){if(o.success&&"0"!=o.success){showAlertMsg({container:"#dlg-frmgeoprocess .msg-board",typemsg:"alert-info",msg:"<h4>"+o.msg+"</h4>",delay:0});var t=o.idgeoproceso,n=setInterval(function(){$.ajax({dataType:"json",url:GEOSICOB_URL+"geoprocesamientolist.php",data:{cmd:"search",x_idgeoproceso:t,opciones:"webservice"},beforeSend:function(e){showAlertMsg({container:"#dlg-frmgeoprocess .msg-board",typemsg:"alert-info",msg:'<div><i class="fa fa-clock-o fa-spin fa-fw fa-3x"></i><span class="h4 pull-left">Espere por favor...</span></div>'})},success:function(o){if(parseInt(o.pager.RecordCount)>0){var t=JSON.parse(o.rows[0].salida)||{};if(jQuery.isEmptyObject(t))return void showAlertMsg({container:"#dlg-frmgeoprocess .msg-board",typemsg:"alert-info",msg:'<div><i class="fa fa-cog fa-spin fa-fw fa-3x"></i><span class="h4 pull-left">Procesando...</span></div>',delay:0});if(t.hasOwnProperty("error"))return showAlertMsg({container:"#dlg-frmgeoprocess .msg-board",typemsg:"alert-danger",msg:t.error,delay:0}),clearInterval(n),void r.button("reset");if(clearInterval(n),r.button("reset"),showAlertMsg({container:"#dlg-frmgeoprocess .msg-board",typemsg:"alert-success",msg:'<div><i class="fa fa-thumbs-o-up fa-3x"></i><span class="h4 pull-left">Proceso completado.</span></div>',delay:400}),o.rows[0].geojson&&(t.lyr_geojson=o.rows[0].geojson),e.actions&&e.actions.onSuccess&&""!==e.actions.onSuccess&&"function"==typeof window[e.actions.onSuccess]&&!window[e.actions.onSuccess](t))return;if($("#dlg-frmgeoprocess .close").click(),e.templates&&e.templates.result){var a=tmpl("tmpl-geoprocess-result",{gp:e,in:s,out:t});$("#tool-geoprocess-history").prepend(document.getElementById("tool-geoprocess-result").innerHTML),document.getElementById("tool-geoprocess-result").innerHTML=a,$("#geoprocess-count").text(parseInt($("#geoprocess-count").text())+1),$('a[href="#tool-geoprocess-history"]').show(),$('a[href="#geoprocesses"]').trigger("click").delay(800).promise().done(function(){$('a[href="#tool-geoprocess-result"]').show().trigger("click")})}}},error:function(){clearInterval(n),r.button("reset")}})},3e3);$("#dlg-frmgeoprocess").one("hide.bs.modal",function(){clearInterval(n)})}else showAlertMsg({container:"#dlg-frmgeoprocess .msg-board",typemsg:"alert-danger",msg:o.msg,delay:0}),r.button("reset")},error:function(e,o,s){r.button("reset"),showAlertMsg({container:"#dlg-frmgeoprocess .msg-board",typemsg:"alert-danger",msg:o,delay:0})}}),!1}}function renderGeoprocessPanel(e,o){var s=document.getElementById(o);if(void 0!==s){$(s).addClass("basemap container-fluid");var r=tmpl("tmpl-geoprocess-item",e);$(s).append(r)}}